IMAGES = images/logo.pdf
DOCUMENTS = guest-sign-sheet.pdf waiver.pdf membership-form.pdf space-rules.pdf binder-cover.pdf dropbox-dues.pdf donation-form.pdf contact-form.pdf

all: $(DOCUMENTS)

clean:
	rm -f {,images/}*.pdf {,images/}*.log {,images/}*.out {,images/}*.aux

$(DOCUMENTS): $(IMAGES)

%.pdf: %.svg
		inkscape -z -T -A $@ $<

%.pdf: %.latex %.version.latex synhak.cls Makefile
		pdflatex -output-format=pdf $<

%.version.latex: ../.git/logs/HEAD
	echo "%%% This file is generated by Makefile.\n" >> $@
	echo "%%% Do not edit!\n" >> $@
	git log -1 --format="format:\
			\\gdef\\GITAbrHash{%h}\
			\\gdef\\GITAuthorDate{%ad}\
			\\gdef\\GITAuthorName{%an}" $*.latex >> $@
	git status -s $*.latex | grep ?? && echo "\\gdef\\GITAbrHash{UNCOMMITTED}\\gdef\\GITAuthorDate{??/??/??}\\gdef\\GITAuthorName{${USER}@${HOSTNAME}}" >> $@ || exit 0

.PHONY: all clean
