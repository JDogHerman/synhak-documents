IMAGES = images/logo.pdf
DOCUMENTS = guest-sign-sheet.pdf \
						waiver.pdf \
						membership-form.pdf \
						space-rules.pdf \
						binder-cover.pdf \
						dropbox-dues.pdf \
						donation-form.pdf \
						contact-form.pdf \
						insurance-2012-08-31.pdf \
						insurance-2012-11-07.pdf \
						checkout-form.pdf \
						checkout-policy.pdf \
						dues-envelope.pdf \
						flyer.pdf \

all: $(DOCUMENTS)

clean:
	rm -f {,images/}*.pdf {,images/}*.log {,images/}*.out {,images/}*.aux

$(DOCUMENTS): $(IMAGES)

images/logo.svg:
	ln -s ../../svg/logo.svg images/logo.svg

%.pdf: %.svg
		inkscape -z -T -A $@ $<

%.pdf: %.latex %.version.latex synhak.cls Makefile
		pdflatex -output-format=pdf $<

%.version.latex: ../.git/logs/HEAD
	echo "%%% This file is generated by Makefile.\n" >> $@
	echo "%%% Do not edit!\n" >> $@
	git log -1 --format="format:\
			\\gdef\\GITAbrHash{%h}\
			\\gdef\\GITAuthorDate{%ad}\
			\\gdef\\GITAuthorName{%an}" $*.latex >> $@
	git status -s $*.latex | grep ?? && echo "\\gdef\\GITAbrHash{UNCOMMITTED}\\gdef\\GITAuthorDate{??/??/??}\\gdef\\GITAuthorName{${USER}@${HOSTNAME}}" >> $@ || exit 0
	git status -s $*.latex | grep ^A && echo "\\gdef\\GITAbrHash{UNCOMMITTED}\\gdef\\GITAuthorDate{??/??/??}\\gdef\\GITAuthorName{${USER}@${HOSTNAME}}" >> $@ || exit 0

.PHONY: all clean
